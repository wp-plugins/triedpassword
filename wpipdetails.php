<?php ob_start();?><?phpclass  GetIpDetails  {function get_wpd_user( $wp_user_id=null ) {$user = get_user_by( 'id', $wp_user_id );if ( $user != false ) {return sprintf(__('%1$s (%2$s) %3$s', 'login_security'),$user->display_name,$user->user_email);} else {// return a message to explain the user is unknowreturn __('Unknown user', 'login_security');}}function get_wpd_referer() {return (isset($_SERVER['HTTP_REFERER'])    ? esc_attr(trim($_SERVER['HTTP_REFERER'])) : '');}function get_wpd_user_agent() {return (isset($_SERVER['HTTP_USER_AGENT']) ? esc_attr(trim($_SERVER['HTTP_USER_AGENT'])) : '');}function get_wp_ip() {$ip_address = '';// IP if internet is shared if (isset($_SERVER['HTTP_CLIENT_IP']) && !empty($_SERVER['HTTP_CLIENT_IP'])) {$ip_address = $_SERVER['HTTP_CLIENT_IP'];}// IP behind a  different serverelseif (isset($_SERVER['HTTP_X_FORWARDED_FOR']) && !empty($_SERVER['HTTP_X_FORWARDED_FOR'])) {$ip_address = $_SERVER['HTTP_X_FORWARDED_FOR'];}// Genral  IPelseif (isset($_SERVER['REMOTE_ADDR']) && !empty($_SERVER['REMOTE_ADDR'])) {$ip_address = $_SERVER['REMOTE_ADDR'];}// if not  : empty stringelse {$ip_address = '';}// Check weather there are multiple IP adresseif (strpos($ip_address, ',') !== false) {$ip_address = explode(',', $ip_address);$ip_address = current($ip_address);}return esc_attr($ip_address);}}